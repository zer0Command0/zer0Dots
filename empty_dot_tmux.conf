# ╔══════════════════════════════════════════════════════════╗
# ║  tmux Configuration - zer0                              ║
# ║  Prefix: Ctrl-a                                         ║
# ║  Nessun conflitto con AeroSpace (Hyper key)             ║
# ╚══════════════════════════════════════════════════════════╝

# -----------------------------------------------------------
# Generale
# -----------------------------------------------------------
# Prefix: Ctrl-a (più comodo di Ctrl-b)
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# True color per Ghostty + catppuccin
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-ghostty:RGB,xterm-256color:RGB"

# Risposta tasti veloce
set -s escape-time 0
set -g history-limit 50000
set -g display-time 4000
set -g status-interval 5
set -g focus-events on

# Mouse
set -g mouse on

# Numerazione finestre/pane da 1
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on

# -----------------------------------------------------------
# Scorciatoie - Split
# -----------------------------------------------------------
# Split intuitivi (nella stessa directory)
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Nuova finestra nella stessa directory
bind c new-window -c "#{pane_current_path}"

# -----------------------------------------------------------
# Scorciatoie - Navigazione pane (vim-style)
# Ctrl+h/j/k/l senza prefix — zero conflitti con AeroSpace
# -----------------------------------------------------------
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

# Ridimensiona pane con prefix + H/J/K/L
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# -----------------------------------------------------------
# Scorciatoie - Copy mode (vi-style)
# -----------------------------------------------------------
setw -g mode-keys vi
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# -----------------------------------------------------------
# Scorciatoie - Utility
# -----------------------------------------------------------
# Ricarica config
bind r source-file ~/.tmux.conf \; display "Config ricaricata!"

# Alterna ultimo window
bind Space last-window

# -----------------------------------------------------------
# Plugin (TPM)
# -----------------------------------------------------------
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'catppuccin/tmux'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Catppuccin
set -g @catppuccin_flavor 'mocha'
set -g @catppuccin_window_status_style 'rounded'

# Resurrect / Continuum
set -g @continuum-restore 'on'

# Inizializza TPM (deve essere l'ultima riga)
run '~/.tmux/plugins/tpm/tpm'
